/*! angular-d3-charts - v0.1.0 - 2014-05-15
* https://github.com/elesdoar/angular-d3-charts
* Copyright (c) 2014 ; Licensed MIT */
!function(){"use strict";angular.module("angular-d3-charts",[]).directive("a3bar",function(a,b,c,d,e){return{restrict:"EA",replace:!0,scope:{options:"=options"},template:'<div class="angular-a3bar"></div>',controller:function(b){a.info("[Angular - D3] Bar scope controller",b)},link:function(a,f,g){a.container=f;var h,i=b.isDefined,j=e.setDefaults(a.options,g.id),k=i(g.width)?g.width:j.width,l=i(g.height)?g.height:j.height;isNaN(k)?f.css("width",k):f.css("width",k+"px"),isNaN(l)?f.css("height",l):f.css("height",l+"px"),j.width=f.width(),j.height=f.height(),d.setXScale(a,j),d.setYScale(a,j),h=c.addSVG(a,f.get(0),j),f.width(j.containerWidth),f.height(j.containerHeight),d.addAxis(a,j),c.updateStyles(a,j)}}}),angular.module("angular-d3-charts").factory("d3Helpers",function(a){function b(b,c){var d,e;if(angular.isDefined(c))d=c;else if(1===Object.keys(b).length)for(e in b)b.hasOwnProperty(e)&&(d=e);else 0===Object.keys(b).length?d="main":a.error("[AngularJS - D3] - You have more than 1 object on the DOM, you must provide the object ID");return d}return{isEmpty:function(a){return 0===Object.keys(a).length},isUndefinedOrEmpty:function(a){return angular.isUndefined(a)||null===a||0===Object.keys(a).length},isDefined:function(a){return angular.isDefined(a)&&null!==a},isNumber:function(a){return angular.isNumber(a)},isString:function(a){return angular.isString(a)},isArray:function(a){return angular.isArray(a)},isObject:function(a){return angular.isObject(a)},isFunction:function(a){return angular.isFunction(a)},equals:function(a,b){return angular.equals(a,b)},safeApply:function(a,b){var c=a.$root.$$phase;"$apply"===c||"$digest"===c?a.$eval(b):a.$apply(b)},getRandomString:function(a){for(var b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",c=a||8,d="",e=0;c>e;e++){var f=Math.floor(Math.random()*b.length);d+=b.substring(f,f+1)}return d},obtainEffectiveChartId:b}}),angular.module("angular-d3-charts").factory("barDefaults",function(a){function b(){return{width:300,heigth:250,zoom:!0,margin:{left:10,right:10,top:10,bottom:10},legend:{show:!0,width:120},series:["A","B","C","D"],x:{domain:["Fruits","Vegetables","Meet"],tickFormat:null,tickSize:6,orient:"bottom",position:"bottom",key:"x",label:"x",ticks:5,tickSubdivide:4},y:{scale:"linear",tickFormat:null,tickSize:6,orient:"left",position:"left",key:"y",label:"y",ticks:5,tickSubdivide:4},timeFormat:"%d-%m-%Y",fontFamily:"Arial",fontSize:"0.75em",axis:{stroke:"#000",fill:"#000"},defaultData:[{x:"Fruits",y:[54,0,879],tooltip:"Fruits tooltip"},{x:"Vegetables",y:[12,34,15],tooltip:"Vegetables tooltip"},{x:"Meet",y:[54,432,234],tooltip:"Meet tooltip"}],showDefaultData:!0,locale:null}}var c=a.isDefined,d=a.obtainEffectiveChartId,e={};return{getDefaults:function(a){var b=d(e,a);return e[b]},getCreationDefaults:function(a){var b=this.getDefaults(a),c={};return angular.extend(c,b),c},setDefaults:function(a,f){var g=b();c(a)&&(g.width=c(a.width)?a.width:g.width,g.heigth=c(a.heigth)?a.heigth:g.heigth,g.zoom=c(a.zoom)?a.zoom:g.zoom,g.timeFormat=c(a.timeFormat)?a.timeFormat:g.timeFormat,g.fontFamily=c(a.fontFamily)?a.fontFamily:g.fontFamily,g.fontSize=c(a.fontSize)?a.fontSize:g.fontSize,g.showDefaultData=c(a.showDefaultData)?a.showDefaultData:g.showDefaultData,g.locale=c(a.locale)?a.locale:g.locale,c(a.margin)&&angular.extend(g.margin,a.margin),c(a.legend)&&angular.extend(g.legend,a.legend),c(a.x)&&angular.extend(g.x,a.x),c(a.axis)&&angular.extend(g.axis,a.axis),c(g.defaultData)&&angular.extend(g.defaultData,g.defaultData));var h=d(e,f);return e[h]=g,g}}}),angular.module("angular-d3-charts").factory("barHelpers",function(a,b){return{addAxis:function(c,d){c.xl=c.svg.append("g").attr("class","x axis");var e="left"===d.y.orient?25:0;if(!b.isDefined(d.x.position)||b.isString(d.x.position))switch(d.x.position){case"top":c.xl.attr("transform","translate("+e+", "+("bottom"===d.x.orient?0:20)+")");break;default:b.isDefined(d.x.position)&&b.isString(d.x.position)&&"bottom"===d.x.position||(a.warn('[Angular - D3] Axis position must be a string. Setting default value "bottom"'),d.x.position="bottom"),c.xl.attr("transform","translate("+e+", "+("bottom"===d.x.orient?d.height-20:d.height)+")")}else b.isNumber(d.x.position)&&c.xl.attr("transform","translate("+e+", "+("bottom"===d.x.orient?d.x.position-20:d.x.position)+")");c.xl.call(c.xAxis),b.isDefined(d.x.label)&&d.x.label!==!1&&c.xl.append("text").attr("class","label").attr("transform","translate("+d.width+")").attr("dx","1em").style("text-anchor","start").style("font-size","1.1em").text(d.x.label),c.yl=c.svg.append("g").attr("class","y axis").attr("transform","translate("+("left"===d.y.orient?20:0)+","+("bottom"===d.x.orient?0:30)+")").call(c.yAxis)},setXScale:function(c,d){c.x=d3.scale.ordinal(),b.isDefined(c.xAxis)?c.xAxis.scale(c.x):((!b.isDefined(d.x.orient)||!b.isString(d.x.orient)||"bottom"!==d.x.orient&&"top"!==d.x.orient)&&(a.warn('[Angular - D3] Tick orient must be a string. Setting default value "bottom"'),d.x.orient="bottom"),c.xAxis=d3.svg.axis().scale(c.x).orient(d.x.orient)),b.isDefined(d.x.tickSize)&&b.isNumber(d.x.tickSize)?c.xAxis.tickSize(d.x.tickSize):(a.warn("[Angular - D3] Ticksize must be a number. Setting default value 6"),d.x.tickSize=6,c.xAxis.tickSize(d.x.tickSize)),c.x.domain(d.x.domain).rangeBands([0,d.width],.2),c.xAxis.tickFormat(d.x.tickFormat),b.isDefined(c.chartData)&&this.updateData(c.chartData)},setYScale:function(c,d){switch(d.y.scale){case"log":c.y=d3.scale.log().clamp(!0);break;case"sqrt":c.y=d3.scale.sqrt();break;case"time":c.y=d3.time.scale();break;default:"linear"!==d.y.scale&&(a.warn('[Angular - D3] Ticksize must be a string and ["linear", "log", "time", "sqrt"]. Setting default value "linear"'),d.y.scale="linear"),c.y=d3.scale.linear()}switch(c.y.range([0,d.width]),b.isDefined(c.yAxis)?c.yAxis.scale(c.y):(b.isDefined(d.y.orient)&&b.isString(d.y.orient)||(a.warn('[Angular - D3] Tick orient must be a string. Setting default value "left"'),d.y.orient="left"),c.yAxis=d3.svg.axis().scale(c.y).orient(d.y.orient)),b.isDefined(d.y.tickSize)&&b.isNumber(d.y.tickSize)?c.yAxis.tickSize(d.y.tickSize):(a.warn("[Angular - D3] Ticksize must be a number. Setting default value 6"),d.y.tickSize=6,c.yAxis.tickSize(d.y.tickSize)),d.y.scale){case"log":b.isDefined(d.y.tickFormat)||(d.y.tickFormat=function(a){var b=d3.round(Math.log(a)/Math.LN10,3);return b%1===0?a:""}),c.yAxis.ticks(d.y.ticks),c.y.domain([.1,1e3]);break;case"time":if(!b.isDefined(d.y.tickFormat)){var e=b.isDefined(d.locale)?d.locale.timeFormat:d3.time.format;d.y.tickFormat=e.multi([[".%L",function(a){return a.getMilliseconds()}],[":%S",function(a){return a.getSeconds()}],["%I:%M",function(a){return a.getMinutes()}],["%I %p",function(a){return a.getHours()}],["%a %d",function(a){return a.getDay()&&1!==a.getDate()}],["%b %d",function(a){return 1!==a.getDate()}],["%B",function(a){return a.getMonth()}],["%Y",function(){return!0}]])}c.yAxis.ticks(d.y.ticks);break;default:c.yAxis.ticks(d.y.ticks+d.y.ticks*d.y.tickSubdivide),c.y.domain([0,100])}c.yAxis.tickFormat(d.y.tickFormat),b.isDefined(c.chartData)&&this.updateData(c.chartData)},updateData:function(){}}}),angular.module("angular-d3-charts").factory("svgHelpers",function(a){return{addSVG:function(b,c,d){var e=d.width+d.margin.left+d.margin.right;e+=d.legend.show?d.legend.width:0;var f=d.height+d.margin.top+d.margin.bottom+30;d.containerWidth=e,d.containerHeight=f;var g=d3.select(c).append("svg").attr("width",e).attr("height",f).append("g").attr("transform","translate("+d.margin.left+","+d.margin.top+")").style("cursor","pointer");return b.idClip="clip-"+a.getRandomString(),g.append("clipPath").attr("id",b.idClip).append("rect").attr("width",d.width-1).attr("height",d.height-20),b.svg=g,g},updateStyles:function(a,b){a.svg.selectAll(".axis path").style("stroke",b.axis.stroke).style("fill","none").style("shape-rendering","crispEdges"),a.svg.selectAll(".axis .tick line").style("stroke",b.axis.stroke).style("fill",b.axis.fill),a.svg.selectAll(".axis .tick.minor").style("stroke",b.axis.stroke).style("fill",b.axis.fill),a.svg.style("font-family",b.fontFamily),a.svg.style("font-size",b.fontSize)}}})}();